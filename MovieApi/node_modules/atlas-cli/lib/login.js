import readlineSync from 'readline-sync';

import {
  saveConfiguration,
  CONFIGURATION_FILE,
} from './config';

const login = (_cmd, _options) => {
  console.log('Create a new API key:');
  console.log('');
  console.log('    https://www.beautifulatlas.com/settings');
  console.log('');

  setTimeout(async () => {
    console.log('Please insert your newly created key:');
    const token = readlineSync.question('');

    if (token.length > 0) {
      try {
        await saveConfiguration('authToken', token);
      } catch (e) {
        console.error(e);
      }

      console.log(`\nLogin credentials are stored in ${CONFIGURATION_FILE}`);
    }
  }, 1000);
};

export default login;
